<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Onyx AI Solutions</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Base styles for the entire website */
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(180deg, #0a0a0a 0%, #1a1a1a 100%); /* Deep Onyx background */
            color: #e0e0e0; /* Light gray text */
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            scroll-behavior: smooth;
        }

        /* Main tab content display */
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }

        /* General loading spinner for main website */
        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-left-color: #8b5cf6; /* Tailwind purple-500 equivalent */
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Custom scrollbar for a sleek look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #2a2a2a;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #4a4a4a;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6a6a6a;
        }

        /* --- Resume Scanner Specific Styles (Prefixed to avoid conflicts) --- */
        /* These styles are for the embedded Resume Scanner section only */

        .rs-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .rs-hero {
            padding: 60px 0;
            text-align: center;
        }
        .rs-hero h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1e293b; /* Dark text on light background */
            margin-bottom: 16px;
        }
        .rs-subheadline {
            font-size: 1.25rem;
            color: #475569; /* Grey text */
            margin-bottom: 32px;
            max-width: 600px;
            margin: 0 auto 32px;
        }

        .rs-upload-section {
            background: #ffffff; /* White background */
            border-radius: 12px;
            padding: 32px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            margin: 0 auto;
        }
        .rs-upload-box, .rs-job-desc-box {
            margin-bottom: 24px;
        }
        .rs-upload-label {
            display: block;
            font-size: 1rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 8px;
            text-align: left;
        }
        .rs-input-file, .rs-textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease, background-color 0.3s ease;
            background: #fff;
            color: #1e293b;
        }
        .rs-textarea {
            min-height: 120px;
            resize: vertical;
        }
        .rs-input-file:focus, .rs-textarea:focus {
            border-color: #6366f1; /* Blue accent */
            outline: none;
        }
        .rs-cta-button {
            background-color: #6366f1; /* Blue accent */
            color: #fff;
            padding: 16px 32px;
            font-size: 1.125rem;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            width: 100%;
            max-width: 300px;
            display: block;
            margin: 0 auto;
        }
        .rs-cta-button:hover {
            background-color: #4f46e5;
            transform: translateY(-2px);
        }

        .rs-results-section {
            margin-top: 40px;
            background: #ffffff;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 24px;
        }

        .rs-ats-score {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 24px;
            position: relative;
        }
        .rs-progress-ring {
            position: relative;
            width: 120px;
            height: 120px;
            margin-bottom: 16px;
        }
        .rs-progress-ring .progress-background {
            stroke: #e2e8f0;
            stroke-width: 8;
            fill: none;
        }
        .rs-progress-ring .progress {
            stroke: #6366f1;
            stroke-width: 8;
            fill: none;
            stroke-dasharray: 314;
            stroke-dashoffset: 314;
            transition: stroke-dashoffset 0.5s ease;
            stroke-linecap: round;
            transform: rotate(-90deg);
            transform-origin: 60px 60px;
        }
        .rs-progress-ring .score-text-svg {
            font-size: 1.8rem;
            font-weight: 700;
            fill: #1e293b;
        }

        .rs-summary-rewrite {
            text-align: center;
            margin-bottom: 24px;
            width: 100%;
        }
        .rs-summary-rewrite p {
            font-size: 1.1rem;
            color: #475569;
        }

        .rs-tab-container {
            width: 100%;
            margin-top: 20px;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
            background-color: #f8fafc;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        .rs-tab-buttons {
            display: flex;
            border-bottom: 1px solid #e2e8f0;
            background-color: #f0f4ff;
        }

        .rs-tab-button {
            flex: 1;
            padding: 18px 25px;
            border: none;
            background-color: transparent;
            font-size: 1.15rem;
            font-weight: 600;
            color: #475569;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 4px solid transparent;
            position: relative;
            text-align: center;
        }

        .rs-tab-button:hover {
            background-color: #e2e8f0;
            color: #1e293b;
        }

        .rs-tab-button.active {
            color: #6366f1;
            border-bottom: 4px solid #6366f1;
            background-color: #ffffff;
            box-shadow: 0 -2px 8px rgba(99, 102, 241, 0.1);
        }

        .rs-tab-content {
            padding: 20px;
            display: none;
            background-color: #ffffff;
        }

        .rs-tab-content.active {
            display: block;
        }

        .rs-tab-content-card {
            background: #f0f4ff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.1);
            margin-bottom: 20px;
            color: #1e293b;
            line-height: 1.5;
            max-height: 400px;
            overflow-y: auto;
        }
        .rs-tab-content-card:last-child {
            margin-bottom: 0;
        }

        .rs-tab-content-card h3 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #4f46e5;
            margin-bottom: 16px;
            border-bottom: 2px solid #c7d2fe;
            padding-bottom: 8px;
        }

        .rs-tab-content-card ul {
            list-style-position: inside;
            padding-left: 0;
            margin-left: 0;
        }
        .rs-tab-content-card ul li {
            margin-bottom: 8px;
            padding-left: 24px;
            position: relative;
            background: #e0e7ff;
            border-radius: 8px;
            padding: 10px 16px;
            box-shadow: 0 1px 4px rgba(99, 102, 241, 0.1);
            font-weight: 500;
            color: #3730a3;
        }
        .rs-tab-content-card ul li::before {
            content: "•";
            color: #4f46e5;
            position: absolute;
            left: 8px;
            font-size: 1.5rem;
            line-height: 1;
        }

        .rs-checklist ul li.failed {
            color: #dc2626;
            font-weight: 600;
        }
        .rs-checklist ul li.passed {
            color: #16a34a;
            font-weight: 600;
        }

        .rs-tailored-resume {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 200px;
            text-align: center;
            background: #f0f4ff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.1);
        }

        .rs-tailored-resume h3 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #4f46e5;
            margin-bottom: 20px;
            border-bottom: none;
            padding-bottom: 0;
        }

        .rs-tailored-resume .rs-cta-button {
            margin-top: 0;
            max-width: 280px;
            padding: 15px 30px;
            font-size: 1.1rem;
            box-shadow: 0 4px 8px rgba(99, 102, 241, 0.2);
        }

        /* Loading Overlay and Animation (for Resume Scanner) */
        #rs-message-box-overlay { /* Custom message box for RS */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001;
            visibility: hidden;
            opacity: 0;
            transition: visibility 0s, opacity 0.3s ease;
        }
        #rs-message-box-overlay.visible {
            visibility: visible;
            opacity: 1;
        }
        .rs-message-box-content {
            background-color: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 400px;
            width: 90%;
            font-family: 'Inter', sans-serif;
        }
        .rs-message-box-content p {
            font-size: 1.1rem;
            color: #1e293b;
            margin-bottom: 20px;
        }
        .rs-message-box-content button {
            background-color: #6366f1;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease;
        }
        .rs-message-box-content button:hover {
            background-color: #4f46e5;
        }

        #rs-loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            font-size: 1.5rem;
            color: #6366f1;
            font-weight: 700;
            visibility: hidden;
            opacity: 0;
            transition: visibility 0s, opacity 0.3s ease;
        }
        #rs-loading-overlay .loader {
            border: 6px solid #f3f3f3;
            border-top: 6px solid #6366f1;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            animation: spin 1s linear infinite;
        }


        .rs-how-it-works {
            padding: 60px 0;
            background: #ffffff;
            box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.05);
        }
        .rs-how-it-works h2 {
            font-size: 2rem;
            text-align: center;
            margin-bottom: 40px;
            color: #1e293b;
        }
        .rs-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px,1fr));
            gap: 24px;
            text-align: center;
        }
        .rs-step h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #1e293b;
        }
        .rs-step p {
            color: #475569;
        }

        .rs-trust-section {
            padding: 40px 0;
            background: #f8fafc;
            box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.03);
        }
        .rs-trust-icons {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
        }
        .rs-trust-item p {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1e293b;
            padding: 12px;
            border: 1px solid #e0e7ff;
            border-radius: 8px;
            background-color: #ffffff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        /* Mobile Responsiveness for Resume Scanner */
        @media (max-width: 768px) {
            .rs-hero h1 { font-size: 1.875rem; }
            .rs-subheadline { font-size: 1rem; }
            .rs-upload-section { padding: 24px; }
            .rs-cta-button { font-size: 1rem; padding: 12px 24px; }
            .rs-steps { grid-template-columns: 1fr; }
            .rs-tab-buttons { flex-direction: column; }
            .rs-tab-button { border-bottom: none; border-right: 3px solid transparent; }
            .rs-tab-button.active { border-bottom: none; border-right: 3px solid #6366f1; }
            .rs-tab-content-card {
                max-height: 300px;
            }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <!-- Header -->
    <header class="bg-gray-900 text-white p-4 shadow-xl border-b border-gray-800 fixed w-full z-50 top-0">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center">
            <h1 class="text-4xl font-extrabold mb-4 md:mb-0 text-transparent bg-clip-text bg-gradient-to-r from-purple-500 to-blue-500">Onyx AI Solutions</h1>
            <nav class="flex flex-wrap justify-center md:justify-end space-x-2 md:space-x-4">
                <button class="tab-button p-2 rounded-lg hover:bg-gray-800 transition-colors text-gray-200 font-medium" data-tab="home">Home</button>
                <button class="tab-button p-2 rounded-lg hover:bg-gray-800 transition-colors text-gray-200 font-medium" data-tab="resume-scanner">AI Resume Scanner</button>
                <button class="tab-button p-2 rounded-lg hover:bg-gray-800 transition-colors text-gray-200 font-medium" data-tab="predictive-modeling">Predictive Modeling</button>
                <button class="tab-button p-2 rounded-lg hover:bg-gray-800 transition-colors text-gray-200 font-medium" data-tab="nlp-feedback">NLP Feedback Analysis</button>
                <button class="tab-button p-2 rounded-lg hover:bg-gray-800 transition-colors text-gray-200 font-medium" data-tab="computer-vision">Computer Vision QC</button>
                <button class="tab-button p-2 rounded-lg hover:bg-gray-800 transition-colors text-gray-200 font-medium" data-tab="contact">Contact</button>
                <button id="logoutButton" class="hidden p-2 rounded-lg bg-red-700 hover:bg-red-800 transition-colors text-white font-medium">Logout</button>
            </nav>
        </div>
    </header>

    <main class="flex-grow container mx-auto p-4 md:p-8 mt-20"> <!-- Added mt-20 to account for fixed header -->
        <!-- Message Display Area (for main website messages) -->
        <div id="messageDisplay" class="hidden p-3 mb-4 rounded-md text-sm font-medium" role="alert"></div>

        <!-- Home Tab Content -->
        <section id="home" class="tab-content active bg-gray-800 p-6 rounded-xl shadow-2xl border border-gray-700">
            <div class="py-12 md:py-20 text-center">
                <h2 class="text-5xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-blue-400 mb-6 animate-pulse">
                    Innovate with Intelligence
                </h2>
                <p class="text-gray-300 mb-10 text-xl leading-relaxed max-w-4xl mx-auto">
                    Onyx AI Solutions delivers cutting-edge artificial intelligence to optimize your business operations, enhance decision-making, and drive unprecedented growth.
                </p>
                <a href="#services" class="inline-block bg-gradient-to-r from-purple-600 to-blue-600 text-white py-4 px-8 rounded-full text-lg font-semibold shadow-lg hover:from-purple-700 hover:to-blue-700 transition-all duration-300 transform hover:scale-105">
                    Explore Our Services
                </a>
            </div>

            <div id="authForms" class="bg-gray-900 p-8 rounded-xl shadow-2xl border border-gray-700 mt-12 max-w-2xl mx-auto">
                <h3 class="text-3xl font-bold text-gray-100 mb-8 text-center">Join Onyx AI Today</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Login Form -->
                    <div class="p-6 rounded-lg border border-gray-700 bg-gray-800 shadow-lg">
                        <h4 class="text-2xl font-semibold text-gray-100 mb-6 text-center">Login to Your Account</h4>
                        <form id="loginForm" class="space-y-6">
                            <div>
                                <label for="loginEmail" class="block text-sm font-medium text-gray-400 mb-2">Email Address</label>
                                <input type="email" id="loginEmail" class="mt-1 block w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500 text-gray-200 placeholder-gray-400" placeholder="your.email@example.com" required>
                            </div>
                            <div>
                                <label for="loginPassword" class="block text-sm font-medium text-gray-400 mb-2">Password</label>
                                <input type="password" id="loginPassword" class="mt-1 block w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500 text-gray-200 placeholder-gray-400" placeholder="••••••••" required>
                            </div>
                            <button type="submit" id="loginButton" class="w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white py-3 px-4 rounded-lg hover:from-purple-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-300 flex items-center justify-center font-semibold text-lg">
                                Login
                                <div id="loginSpinner" class="loading-spinner ml-3 hidden"></div>
                            </button>
                        </form>
                    </div>

                    <!-- Register Form -->
                    <div class="p-6 rounded-lg border border-gray-700 bg-gray-800 shadow-lg">
                        <h4 class="text-2xl font-semibold text-gray-100 mb-6 text-center">New User? Register Here</h4>
                        <form id="registerForm" class="space-y-6">
                            <div>
                                <label for="registerEmail" class="block text-sm font-medium text-gray-400 mb-2">Email Address</label>
                                <input type="email" id="registerEmail" class="mt-1 block w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-gray-200 placeholder-gray-400" placeholder="new.user@example.com" required>
                            </div>
                            <div>
                                <label for="registerPassword" class="block text-sm font-medium text-gray-400 mb-2">Password</label>
                                <input type="password" id="registerPassword" class="mt-1 block w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-gray-200 placeholder-gray-400" placeholder="••••••••" required>
                            </div>
                            <button type="submit" id="registerButton" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-4 rounded-lg hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-300 flex items-center justify-center font-semibold text-lg">
                                Register
                                <div id="registerSpinner" class="loading-spinner ml-3 hidden"></div>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- Dashboard Tab Content (Hidden by default, shown upon login) -->
        <section id="dashboard" class="tab-content bg-gray-800 p-6 rounded-xl shadow-2xl border border-gray-700">
            <h2 class="text-3xl font-bold text-gray-100 mb-6">Your Personalized Dashboard</h2>
            <p class="text-gray-300 mb-4">Welcome to your secure area. Here you can manage your account and access exclusive features.</p>
            <div id="userInfo" class="bg-gray-900 p-6 rounded-lg border border-gray-700 shadow-md">
                <p class="text-purple-400 font-medium text-lg mb-2">Logged in as: <span id="userEmail">Guest</span></p>
                <p class="text-gray-400 text-sm mb-4">Your User ID: <span id="userId">N/A</span></p>
                <div class="mt-4">
                    <h3 class="text-xl font-semibold text-gray-100 mb-3">Your Stored Data:</h3>
                    <div id="userDataDisplay" class="bg-gray-700 p-4 rounded-lg text-gray-200 text-sm overflow-x-auto">
                        <pre id="userDataJson">Loading...</pre>
                    </div>
                    <div class="mt-4 flex flex-col md:flex-row md:space-x-4 space-y-4 md:space-y-0">
                        <input type="text" id="dataKeyInput" placeholder="Enter data key" class="flex-grow px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-200 placeholder-gray-400 focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                        <input type="text" id="dataValueInput" placeholder="Enter data value" class="flex-grow px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-200 placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        <button id="saveDataButton" class="bg-purple-600 text-white py-2 px-5 rounded-lg hover:bg-purple-700 transition-colors flex items-center justify-center font-semibold">
                            Save Data
                            <div id="saveDataSpinner" class="loading-spinner ml-2 hidden"></div>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- AI Resume Scanner Tab Content (Integrated Project) -->
        <section id="resume-scanner" class="tab-content bg-gray-800 p-6 rounded-xl shadow-2xl border border-gray-700">
            <h2 class="text-3xl font-bold text-gray-100 mb-6 text-center">AI Resume Scanner</h2>
            <p class="text-gray-300 mb-4 text-center max-w-3xl mx-auto">
                Our AI Resume Scanner helps you quickly analyze resumes for keywords, skills, and relevance to job descriptions. Optimize your hiring process and find the best candidates faster.
            </p>

            <!-- Resume Scanner Project Content Starts Here -->
            <div class="rs-hero">
                <div class="rs-container">
                    <div class="rs-upload-section">
                        <div class="rs-upload-box">
                            <label for="resume-upload" class="rs-upload-label">
                                Upload Resume (PDF/DOCX)
                            </label>
                            <input
                                type="file"
                                id="resume-upload"
                                accept=".pdf,.docx"
                                aria-label="Upload resume file"
                                class="rs-input-file"
                            />
                        </div>

                        <div class="rs-job-desc-box">
                            <label for="job-desc" class="rs-upload-label">
                                Paste Job Description
                            </label>
                            <textarea
                                id="job-desc"
                                placeholder="Paste the job description here..."
                                aria-label="Job description input"
                                class="rs-textarea"
                            ></textarea>
                        </div>

                        <button id="scan-btn" class="rs-cta-button">
                            Scan My Resume
                        </button>
                    </div>

                    <div class="rs-results-section" id="results" style="display: none;">
                        <h2 style="width: 100%; text-align: center; margin-bottom: 24px;">Your Resume Analysis</h2>
                        <div class="rs-score-summary" style="display: flex; align-items: center; margin-bottom: 16px; justify-content: center; position: relative;">
                            <svg class="rs-progress-ring" width="120" height="120">
                                <!-- Background circle for the progress bar -->
                                <circle
                                    class="progress-background"
                                    stroke="#e2e8f0"
                                    stroke-width="8"
                                    fill="transparent"
                                    r="50"
                                    cx="60"
                                    cy="60"
                                />
                                <!-- Actual progress circle -->
                                <circle
                                    class="progress"
                                    stroke="#6366f1"
                                    stroke-width="8"
                                    fill="transparent"
                                    r="50"
                                    cx="60"
                                    cy="60"
                                    stroke-dasharray="314"
                                    stroke-dashoffset="314"
                                />
                                <!-- Score text moved inside SVG for proper centering -->
                                <text x="50%" y="50%" text-anchor="middle" dominant-baseline="middle" class="score-text-svg" fill="#1e293b" font-size="1.5rem" font-weight="700">0%</text>
                            </svg>
                        </div>
                        <!-- Summary text moved here, outside of tabs, and not duplicated -->
                        <div class="rs-summary-rewrite" style="margin-bottom: 24px; text-align: center; width: 100%;">
                            <p id="summary-text" style="font-size: 1.1rem; color: #475569;"></p>
                        </div>

                        <div class="rs-tab-container" style="width: 100%;">
                            <div class="rs-tab-buttons">
                                <button class="rs-tab-button active" data-rs-tab="ai-feedback-tab">AI Feedback</button>
                                <button class="rs-tab-button" data-rs-tab="checklist-tab">Resume Checklist</button>
                                <button class="rs-tab-button" data-rs-tab="tailored-resume-tab">Tailored Resume</button>
                            </div>
                            <div class="rs-tab-content active" id="ai-feedback-tab">
                                <div class="rs-tab-content-card" id="ai-feedback-card">
                                    <h3>AI-Powered Feedback</h3>
                                    <ul id="ai-feedback-list"></ul>
                                </div>
                                <div class="rs-tab-content-card" id="suggestions-card" style="margin-top: 24px;">
                                    <h3>Improvement Suggestions</h3>
                                    <ul id="suggestions-list"></ul>
                                </div>
                            </div>
                            <div class="rs-tab-content" id="checklist-tab">
                                <div class="rs-tab-content-card" id="checklist-card">
                                    <h3>Resume Checklist</h3>
                                    <ul id="checklist-list"></ul>
                                </div>
                            </div>
                            <div class="rs-tab-content" id="tailored-resume-tab">
                                <div class="rs-tab-content-card" id="tailored-resume-card">
                                    <h3>Download Your Tailored Resume</h3>
                                    <p style="color: #475569; margin-bottom: 20px;">Click the button below to download your AI-tailored resume, optimized for the job description.</p>
                                    <a id="download-resume" href="#" class="rs-cta-button" target="_blank">Download Tailored Resume</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <section class="rs-how-it-works">
                <div class="rs-container">
                    <h2>How It Works</h2>
                    <div class="rs-steps">
                        <div class="rs-step">
                            <h3>1. Upload</h3>
                            <p>Upload your resume in PDF or DOCX format and paste the job description.</p>
                        </div>
                        <div class="rs-step">
                            <h3>2. Analyze</h3>
                            <p>Our AI compares your resume to the job description for ATS compatibility.</p>
                        </div>
                        <div class="rs-step">
                            <h3>3. Improve</h3>
                            <p>Get a match score, tailored suggestions, an optimized summary, and in-depth AI feedback.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section class="rs-trust-section">
                <div class="rs-container rs-trust-icons">
                    <div class="rs-trust-item"><p>Private & Secure</p></div>
                    <div class="rs-trust-item"><p>AI-Powered Analysis</p></div>
                    <div class="rs-trust-item"><p>No Sign-Up Needed</p></div>
                </div>
            </section>
            <!-- Resume Scanner Project Content Ends Here -->

        </section>

        <!-- Predictive Modeling Tab Content -->
        <section id="predictive-modeling" class="tab-content bg-gray-800 p-6 rounded-xl shadow-2xl border border-gray-700">
            <h2 class="text-3xl font-bold text-gray-100 mb-6">Predictive Modeling for Businesses</h2>
            <p class="text-gray-300 mb-4">
                Leverage advanced predictive models to forecast market trends, customer behavior, and operational efficiencies. Make data-driven decisions with confidence.
            </p>
            <div class="bg-gray-900 p-6 rounded-lg border border-gray-700 shadow-md">
                <h3 class="text-xl font-semibold text-gray-100 mb-4">Simulate a Prediction</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="inputData1" class="block text-sm font-medium text-gray-400 mb-2">Input Data Point 1</label>
                        <input type="number" id="inputData1" class="w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-200 placeholder-gray-400 focus:outline-none focus:ring-purple-500 focus:border-purple-500" placeholder="e.g., 100">
                    </div>
                    <div>
                        <label for="inputData2" class="block text-sm font-medium text-gray-400 mb-2">Input Data Point 2</label>
                        <input type="number" id="inputData2" class="w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-200 placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="e.g., 0.5">
                    </div>
                </div>
                <button id="predictButton" class="mt-6 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-6 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-300 flex items-center justify-center font-semibold">
                    Run Prediction
                    <div id="predictSpinner" class="loading-spinner ml-3 hidden"></div>
                </button>
                <div id="predictionResult" class="mt-6 p-4 bg-gray-700 rounded-lg text-gray-200 hidden">
                    <h4 class="font-semibold text-lg mb-2">Prediction Output:</h4>
                    <p id="predictionOutput">Your prediction will appear here.</p>
                </div>
            </div>
        </section>

        <!-- NLP for Customer Feedback Tab Content -->
        <section id="nlp-feedback" class="tab-content bg-gray-800 p-6 rounded-xl shadow-2xl border border-gray-700">
            <h2 class="text-3xl font-bold text-gray-100 mb-6">NLP for Customer Feedback Analysis</h2>
            <p class="text-gray-300 mb-4">
                Transform raw customer feedback into actionable insights. Our Natural Language Processing solution identifies sentiment, key themes, and emerging trends from reviews, surveys, and social media.
            </p>
            <div class="bg-gray-900 p-6 rounded-lg border border-gray-700 shadow-md">
                <h3 class="text-xl font-semibold text-gray-100 mb-4">Analyze Customer Comments</h3>
                <textarea id="feedbackText" class="w-full h-48 p-4 bg-gray-700 border border-gray-600 rounded-lg text-gray-200 placeholder-gray-400 focus:outline-none focus:ring-purple-500 focus:border-purple-500 resize-y" placeholder="Enter customer comments here (e.g., 'The product is great but delivery was slow.')..."></textarea>
                <button id="analyzeFeedbackButton" class="mt-4 bg-gradient-to-r from-purple-600 to-blue-600 text-white py-3 px-6 rounded-lg hover:from-purple-700 hover:to-blue-700 transition-all duration-300 flex items-center justify-center font-semibold">
                    Analyze Feedback
                    <div id="feedbackSpinner" class="loading-spinner ml-3 hidden"></div>
                </button>
                <div id="feedbackAnalysisResult" class="mt-6 p-4 bg-gray-700 rounded-lg text-gray-200 hidden">
                    <h4 class="font-semibold text-lg mb-2">Analysis Result:</h4>
                    <p id="feedbackOutput">Sentiment: <span id="sentiment">N/A</span></p>
                    <p id="themes">Themes: <span id="themesOutput">N/A</span></p>
                </div>
            </div>
        </section>

        <!-- Computer Vision for Quality Control Tab Content -->
        <section id="computer-vision" class="tab-content bg-gray-800 p-6 rounded-xl shadow-2xl border border-gray-700">
            <h2 class="text-3xl font-bold text-gray-100 mb-6">Computer Vision for Quality Control</h2>
            <p class="text-gray-300 mb-4">
                Automate visual inspection with AI. Our Computer Vision solutions detect defects, verify assembly, and ensure product quality at scale, reducing errors and costs.
            </p>
            <div class="bg-gray-900 p-6 rounded-lg border border-gray-700 shadow-md">
                <h3 class="text-xl font-semibold text-gray-100 mb-4">Simulate Image Analysis</h3>
                <input type="text" id="imageDescription" class="w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-200 placeholder-gray-400 focus:outline-none focus:ring-purple-500 focus:border-purple-500" placeholder="Describe the image (e.g., 'a product with a scratch', 'perfectly assembled widget')...">
                <button id="analyzeImageButton" class="mt-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-6 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-300 flex items-center justify-center font-semibold">
                    Analyze Image
                    <div id="imageSpinner" class="loading-spinner ml-3 hidden"></div>
                </button>
                <div id="imageAnalysisResult" class="mt-6 p-4 bg-gray-700 rounded-lg text-gray-200 hidden">
                    <h4 class="font-semibold text-lg mb-2">Analysis Result:</h4>
                    <p id="imageOutput">Quality Status: <span id="qualityStatus">N/A</span></p>
                    <p id="defects">Detected Defects: <span id="defectsOutput">N/A</span></p>
                </div>
            </div>
        </section>

        <!-- Contact Tab Content -->
        <section id="contact" class="tab-content bg-gray-800 p-6 rounded-xl shadow-2xl border border-gray-700">
            <h2 class="text-3xl font-bold text-gray-100 mb-6">Contact Onyx AI Solutions</h2>
            <p class="text-gray-300 mb-4">
                Have questions or want to discuss a custom AI solution for your business? Reach out to us!
            </p>
            <div class="bg-gray-900 p-6 rounded-lg border border-gray-700 shadow-md max-w-lg mx-auto">
                <form id="contactForm" class="space-y-4">
                    <div>
                        <label for="contactName" class="block text-sm font-medium text-gray-400 mb-2">Your Name</label>
                        <input type="text" id="contactName" class="mt-1 block w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500 text-gray-200 placeholder-gray-400" placeholder="John Doe" required>
                    </div>
                    <div>
                        <label for="contactEmail" class="block text-sm font-medium text-gray-400 mb-2">Your Email</label>
                        <input type="email" id="contactEmail" class="mt-1 block w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-gray-200 placeholder-gray-400" placeholder="your.email@example.com" required>
                    </div>
                    <div>
                        <label for="contactMessage" class="block text-sm font-medium text-gray-400 mb-2">Message</label>
                        <textarea id="contactMessage" rows="5" class="mt-1 block w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500 text-gray-200 placeholder-gray-400 resize-y" placeholder="Tell us about your needs..."></textarea>
                    </div>
                    <button type="submit" id="sendMessageButton" class="w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white py-3 px-4 rounded-lg hover:from-purple-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-300 flex items-center justify-center font-semibold text-lg">
                        Send Message
                        <div id="contactSpinner" class="loading-spinner ml-3 hidden"></div>
                    </button>
                </form>
                <div id="contactSuccessMessage" class="mt-4 p-3 bg-green-900 text-green-200 rounded-md hidden">
                    <p>Thank you for your message! We will get back to you soon.</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-400 p-4 text-center shadow-inner border-t border-gray-800 mt-auto">
        <div class="container mx-auto">
            <p>&copy; 2024 Onyx AI Solutions. All rights reserved.</p>
        </div>
    </footer>

    <!-- Custom Message Box for Resume Scanner (global, but styled for RS) -->
    <div id="rs-message-box-overlay">
        <div class="rs-message-box-content">
            <p id="rs-message-box-text"></p>
            <button id="rs-message-box-ok">OK</button>
        </div>
    </div>

    <!-- Loading Overlay for Resume Scanner (global, but styled for RS) -->
    <div id="rs-loading-overlay">
        <div class="loader"></div>
        <span id="rs-loading-message" style="margin-left: 12px;">Scanning Resume...</span>
    </div>

    <!-- Firebase SDKs and Combined JavaScript -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged, signInWithCustomToken, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot, collection } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global variables provided by the Canvas environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let app;
        let auth;
        let db;
        let userId = null;
        let currentUserEmail = null;
        let isAuthReady = false; // Flag to indicate if auth state has been initially checked

        // --- Utility Functions (Main Website) ---
        function showMessage(message, type = 'info') {
            const display = document.getElementById('messageDisplay');
            display.textContent = message;
            display.classList.remove('hidden', 'bg-red-900', 'text-red-200', 'bg-green-900', 'text-green-200', 'bg-blue-900', 'text-blue-200');
            if (type === 'error') {
                display.classList.add('bg-red-900', 'text-red-200');
            } else if (type === 'success') {
                display.classList.add('bg-green-900', 'text-green-200');
            } else { // info
                display.classList.add('bg-blue-900', 'text-blue-200');
            }
            // Hide after 5 seconds
            setTimeout(() => {
                display.classList.add('hidden');
            }, 5000);
        }

        function showSpinner(buttonId, spinnerId, show) {
            const button = document.getElementById(buttonId);
            const spinner = document.getElementById(spinnerId);
            if (button && spinner) { // Check if elements exist
                if (show) {
                    spinner.classList.remove('hidden');
                    button.disabled = true;
                    button.classList.add('opacity-75', 'cursor-not-allowed');
                } else {
                    spinner.classList.add('hidden');
                    button.disabled = false;
                    button.classList.remove('opacity-75', 'cursor-not-allowed');
                }
            }
        }

        function switchTab(tabId) {
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            const activeButton = document.querySelector(`.tab-button[data-tab="${tabId}"]`);
            if (activeButton) {
                activeButton.classList.add('active');
            }

            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            const activeContent = document.getElementById(tabId);
            if (activeContent) {
                activeContent.classList.add('active');
            }

            // Authentication form visibility logic for 'home' and 'dashboard'
            const authForms = document.getElementById('authForms');
            const dashboardSection = document.getElementById('dashboard');
            const homeSection = document.getElementById('home');

            if (tabId === 'home') {
                if (userId) { // If logged in and on home, show dashboard content, hide auth forms
                    homeSection.classList.remove('active'); // Hide home content
                    dashboardSection.classList.add('active'); // Show dashboard
                } else { // If not logged in and on home, show home content with auth forms
                    homeSection.classList.add('active');
                    authForms.classList.remove('hidden');
                    dashboardSection.classList.remove('active'); // Ensure dashboard is hidden
                }
            } else if (tabId === 'dashboard') {
                if (userId) { // If logged in and on dashboard, show dashboard
                    dashboardSection.classList.add('active');
                    authForms.classList.add('hidden'); // Hide auth forms
                    homeSection.classList.remove('active'); // Hide home content
                } else { // If not logged in and tries to go to dashboard, redirect to home
                    switchTab('home');
                    showMessage("Please log in to access the dashboard.", 'info');
                }
            } else { // For other tabs (e.g., resume-scanner, predictive-modeling)
                authForms.classList.add('hidden'); // Hide auth forms
                dashboardSection.classList.remove('active'); // Ensure dashboard is hidden
                homeSection.classList.remove('active'); // Ensure home is hidden
            }
        }

        // --- Firebase Initialization and Authentication ---
        async function initializeFirebase() {
            try {
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);

                // Listen for auth state changes
                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        userId = user.uid;
                        currentUserEmail = user.email;
                        document.getElementById('logoutButton').classList.remove('hidden');
                        document.getElementById('userEmail').textContent = currentUserEmail || 'N/A';
                        document.getElementById('userId').textContent = userId;
                        if (isAuthReady) {
                            await fetchUserData(userId);
                        }
                        // If auth is ready and user is logged in, and currently on home, switch to dashboard
                        if (isAuthReady && document.getElementById('home').classList.contains('active')) {
                            switchTab('dashboard');
                        }
                    } else {
                        userId = null;
                        currentUserEmail = null;
                        document.getElementById('logoutButton').classList.add('hidden');
                        document.getElementById('userEmail').textContent = 'Guest';
                        document.getElementById('userId').textContent = 'N/A';
                        document.getElementById('userDataJson').textContent = 'No user data available. Please log in.';
                        // If not logged in, and currently on dashboard, switch to home
                        if (document.getElementById('dashboard').classList.contains('active')) {
                            switchTab('home');
                        }
                    }
                    isAuthReady = true; // Mark auth as ready after initial check
                });

                // Sign in with custom token if available, otherwise anonymously
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }
            } catch (error) {
                console.error("Error initializing Firebase:", error);
                showMessage(`Firebase initialization failed: ${error.message}`, 'error');
            }
        }

        // --- User Data Management (Firestore) ---
        async function fetchUserData(currentUserId) {
            if (!db || !currentUserId) {
                console.warn("Firestore or User ID not available for data fetch.");
                return;
            }

            const userDocRef = doc(db, `artifacts/${appId}/users/${currentUserId}/data/profile`);
            onSnapshot(userDocRef, (docSnap) => {
                if (docSnap.exists()) {
                    const userData = docSnap.data();
                    document.getElementById('userDataJson').textContent = JSON.stringify(userData, null, 2);
                } else {
                    document.getElementById('userDataJson').textContent = 'No custom data found for this user.';
                }
            }, (error) => {
                console.error("Error fetching user data:", error);
                showMessage(`Error fetching user data: ${error.message}`, 'error');
                document.getElementById('userDataJson').textContent = 'Error loading data.';
            });
        }

        async function saveUserData() {
            if (!userId) {
                showMessage("Please log in to save data.", 'error');
                return;
            }
            if (!db) {
                showMessage("Database not initialized.", 'error');
                return;
            }

            const key = document.getElementById('dataKeyInput').value.trim();
            const value = document.getElementById('dataValueInput').value.trim();

            if (!key || !value) {
                showMessage("Please enter both a key and a value to save.", 'error');
                return;
            }

            showSpinner('saveDataButton', 'saveDataSpinner', true);
            try {
                const userDocRef = doc(db, `artifacts/${appId}/users/${userId}/data/profile`);
                const docSnap = await getDoc(userDocRef);
                let currentData = {};
                if (docSnap.exists()) {
                    currentData = docSnap.data();
                }
                const newData = { ...currentData, [key]: value };
                await setDoc(userDocRef, newData);
                showMessage("Data saved successfully!", 'success');
                document.getElementById('dataKeyInput').value = '';
                document.getElementById('dataValueInput').value = '';
            } catch (error) {
                console.error("Error saving data:", error);
                showMessage(`Error saving data: ${error.message}`, 'error');
            } finally {
                showSpinner('saveDataButton', 'saveDataSpinner', false);
            }
        }

        // --- Event Listeners (Main Website) ---
        document.addEventListener('DOMContentLoaded', () => {
            initializeFirebase();

            // Main tab switching
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', () => {
                    switchTab(button.dataset.tab);
                });
            });

            // Login Form
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const email = document.getElementById('loginEmail').value;
                    const password = document.getElementById('loginPassword').value;
                    showSpinner('loginButton', 'loginSpinner', true);
                    try {
                        await signInWithEmailAndPassword(auth, email, password);
                        showMessage("Logged in successfully!", 'success');
                        switchTab('dashboard');
                    } catch (error) {
                        console.error("Login error:", error);
                        showMessage(`Login failed: ${error.message}`, 'error');
                    } finally {
                        showSpinner('loginButton', 'loginSpinner', false);
                    }
                });
            }


            // Register Form
            const registerForm = document.getElementById('registerForm');
            if (registerForm) {
                registerForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const email = document.getElementById('registerEmail').value;
                    const password = document.getElementById('registerPassword').value;
                    showSpinner('registerButton', 'registerSpinner', true);
                    try {
                        await createUserWithEmailAndPassword(auth, email, password);
                        showMessage("Account created and logged in!", 'success');
                        switchTab('dashboard');
                    } catch (error) {
                        console.error("Registration error:", error);
                        showMessage(`Registration failed: ${error.message}`, 'error');
                    } finally {
                        showSpinner('registerButton', 'registerSpinner', false);
                    }
                });
            }

            // Logout Button
            const logoutButton = document.getElementById('logoutButton');
            if (logoutButton) {
                logoutButton.addEventListener('click', async () => {
                    try {
                        await signOut(auth);
                        showMessage("Logged out successfully!", 'info');
                        switchTab('home');
                    } catch (error) {
                        console.error("Logout error:", error);
                        showMessage(`Logout failed: ${error.message}`, 'error');
                    }
                });
            }

            // Save Data Button
            const saveDataButton = document.getElementById('saveDataButton');
            if (saveDataButton) {
                saveDataButton.addEventListener('click', saveUserData);
            }

            // --- Resume Scanner Specific JavaScript (Integrated) ---
            const rsScanBtn = document.getElementById('scan-btn');
            const rsAiFeedbackList = document.getElementById('ai-feedback-list');
            const rsTailoredResumeCard = document.getElementById('tailored-resume-card');
            const rsDownloadResume = document.getElementById('download-resume');
            const rsResultsSection = document.getElementById('results');
            const rsSuggestionsList = document.getElementById('suggestions-list');
            const rsSummaryParagraph = document.getElementById('summary-text');
            const rsProgressCircle = document.querySelector('.rs-progress-ring .progress');
            const rsScoreTextSvg = document.querySelector('.rs-progress-ring .score-text-svg');
            const rsChecklistCard = document.getElementById('checklist-card');
            const rsChecklistList = document.getElementById('checklist-list');

            // Custom Message Box functions for Resume Scanner
            const rsMessageBoxOverlay = document.getElementById('rs-message-box-overlay');
            const rsMessageBoxText = document.getElementById('rs-message-box-text');
            const rsMessageBoxOkBtn = document.getElementById('rs-message-box-ok');

            function rsShowMessageBox(message) {
                if (rsMessageBoxText && rsMessageBoxOverlay) {
                    rsMessageBoxText.textContent = message;
                    rsMessageBoxOverlay.classList.add('visible');
                }
            }

            if (rsMessageBoxOkBtn) {
                rsMessageBoxOkBtn.addEventListener('click', () => {
                    if (rsMessageBoxOverlay) {
                        rsMessageBoxOverlay.classList.remove('visible');
                    }
                });
            }

            // Loading Overlay functions for Resume Scanner
            const rsLoadingOverlay = document.getElementById('rs-loading-overlay');
            const rsLoadingMessageSpan = document.getElementById('rs-loading-message');
            const rsLoadingMessages = [
                "Scanning Resume...",
                "Analyzing Keywords...",
                "Generating Feedback...",
                "Tailoring for Success...",
                "Almost Done!"
            ];
            let rsMessageIndex = 0;
            let rsMessageInterval;

            function rsShowLoadingOverlay() {
                if (rsLoadingOverlay && rsLoadingMessageSpan) {
                    rsLoadingOverlay.style.visibility = 'visible';
                    rsLoadingOverlay.style.opacity = 1;
                    rsMessageIndex = 0;
                    rsLoadingMessageSpan.textContent = rsLoadingMessages[rsMessageIndex];
                    rsMessageInterval = setInterval(() => {
                        rsMessageIndex = (rsMessageIndex + 1) % rsLoadingMessages.length;
                        rsLoadingMessageSpan.textContent = rsLoadingMessages[rsMessageIndex];
                    }, 2000); // Change message every 2 seconds
                }
            }

            function rsHideLoadingOverlay() {
                if (rsLoadingOverlay) {
                    clearInterval(rsMessageInterval);
                    rsLoadingOverlay.style.visibility = 'hidden';
                    rsLoadingOverlay.style.opacity = 0;
                }
            }

            if (rsScanBtn) {
                rsScanBtn.addEventListener('click', () => {
                    const fileInput = document.getElementById('resume-upload');
                    const file = fileInput.files[0];
                    const desc = document.getElementById('job-desc').value.trim();

                    if (!file || !desc) {
                        rsShowMessageBox('Please upload a resume and enter a job description.');
                        return;
                    }

                    rsShowLoadingOverlay();

                    const data = new FormData();
                    data.append('resume', file);
                    data.append('job_description', desc);

                    fetch('/scan', { method: 'POST', body: data })
                        .then(res => {
                            if (!res.ok) {
                                return res.json().then(err => Promise.reject(err.error || 'Unknown error'));
                            }
                            return res.json();
                        })
                        .then(d => {
                            rsHideLoadingOverlay();
                            if (d.error) {
                                rsShowMessageBox(d.error);
                                return;
                            }
                            if (rsResultsSection) rsResultsSection.style.display = 'block';

                            const offset = 314 * (1 - d.ats_score / 100);
                            if (rsProgressCircle) rsProgressCircle.style.strokeDashoffset = offset;
                            if (rsScoreTextSvg) rsScoreTextSvg.textContent = d.ats_score + '%';

                            if (rsSuggestionsList) rsSuggestionsList.innerHTML = d.suggestions.map(s => `<li>${s}</li>`).join('');
                            if (rsSummaryParagraph) rsSummaryParagraph.textContent = d.summary;

                            const feedbackLines = d.ai_feedback
                                .split('\n')
                                .filter(line => {
                                    const trimmed = line.trim();
                                    return trimmed !== '' && (/^\d+\./.test(trimmed) || /improv|add|quantify|highlight|focus|ensure/i.test(trimmed));
                                })
                                .map(line => `<li>${line.trim()}</li>`)
                                .join('');
                            if (rsAiFeedbackList) rsAiFeedbackList.innerHTML = feedbackLines;

                            if (d.checklist && d.checklist.length > 0 && rsChecklistList) {
                                rsChecklistList.innerHTML = d.checklist.map(item => {
                                    const icon = item.passed ? '✔️' : '❌';
                                    const liClass = item.passed ? 'passed' : 'failed';
                                    return `<li class="${liClass}">${icon} ${item.criteria}</li>`;
                                }).join('');
                            }

                            if (d.tailored_resume_url && rsDownloadResume) {
                                rsDownloadResume.href = d.tailored_resume_url;
                                rsDownloadResume.style.opacity = '1';
                                rsDownloadResume.style.pointerEvents = 'auto';
                            } else if (rsDownloadResume) {
                                rsDownloadResume.removeAttribute('href');
                                rsDownloadResume.style.opacity = '0.5';
                                rsDownloadResume.style.pointerEvents = 'none';
                            }
                        })
                        .catch((error) => {
                            rsHideLoadingOverlay();
                            console.error('Scan error:', error);
                            rsShowMessageBox(`Scan failed: ${error.message || error}. Please try again.`);
                        });

                    const rsTabButtons = document.querySelectorAll('.rs-tab-button');
                    const rsTabContents = document.querySelectorAll('.rs-tab-content');

                    rsTabButtons.forEach(button => {
                        button.addEventListener('click', () => {
                            rsTabButtons.forEach(btn => btn.classList.remove('active'));
                            rsTabContents.forEach(content => content.classList.remove('active'));

                            button.classList.add('active');
                            const tabId = button.getAttribute('data-rs-tab');
                            const targetContent = document.getElementById(tabId);
                            if (targetContent) {
                                targetContent.classList.add('active');
                            }
                        });
                    });
                });
            }
        });
    </script>
</body>
</html>
